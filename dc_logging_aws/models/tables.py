import aws_cdk.aws_glue_alpha as glue
from models.buckets import (
    dc_monitoring_production_logging,
    pollingstations_public_data,
)
from models.databases import dc_wide_logs_db, polling_stations_public_data_db
from models.models import GlueTable

dc_postcode_searches_table = GlueTable(
    table_name="dc_postcode_searches_table",
    description="All postcode searches from all services.",
    bucket=dc_monitoring_production_logging,
    s3_prefix="dc-postcode-searches",
    database=dc_wide_logs_db,
    data_format=glue.DataFormat.CSV,
    columns={
        "dc_product": glue.Schema.STRING,
        "utm_source": glue.Schema.STRING,
        "utm_campaign": glue.Schema.STRING,
        "utm_medium": glue.Schema.STRING,
        "postcode": glue.Schema.STRING,
        "timestamp": glue.Schema.TIMESTAMP,
        "api_key": glue.Schema.STRING,
        "calls_devs_dc_api": glue.Schema.STRING,
    },
    partition_keys=[
        glue.Column(
            name="day",
            type=glue.Schema.STRING,
        ),
        glue.Column(
            name="hour",
            type=glue.Schema.INTEGER,
        ),
    ],
)

onspd_table = GlueTable(
    table_name="onspd_table",
    description="onspd_table generated by CDK",
    bucket=pollingstations_public_data,
    s3_prefix="ons/onspd/extracted/latest/",
    database=polling_stations_public_data_db,
    data_format=glue.DataFormat.CSV,
    columns={
        "pcd": glue.Schema.STRING,
        "pcd2": glue.Schema.STRING,
        "pcds": glue.Schema.STRING,
        "dointr": glue.Schema.STRING,
        "doterm": glue.Schema.STRING,
        "oscty": glue.Schema.STRING,
        "ced": glue.Schema.STRING,
        "oslaua": glue.Schema.STRING,
        "osward": glue.Schema.STRING,
        "parish": glue.Schema.STRING,
        "usertype": glue.Schema.STRING,
        "oseast1m": glue.Schema.STRING,
        "osnrth1m": glue.Schema.STRING,
        "osgrdind": glue.Schema.STRING,
        "oshlthau": glue.Schema.STRING,
        "nhser": glue.Schema.STRING,
        "ctry": glue.Schema.STRING,
        "rgn": glue.Schema.STRING,
        "streg": glue.Schema.STRING,
        "pcon": glue.Schema.STRING,
        "eer": glue.Schema.STRING,
        "teclec": glue.Schema.STRING,
        "ttwa": glue.Schema.STRING,
        "pct": glue.Schema.STRING,
        "itl": glue.Schema.STRING,
        "statsward": glue.Schema.STRING,
        "oa01": glue.Schema.STRING,
        "casward": glue.Schema.STRING,
        "npark": glue.Schema.STRING,
        "lsoa01": glue.Schema.STRING,
        "msoa01": glue.Schema.STRING,
        "ur01ind": glue.Schema.STRING,
        "oac01": glue.Schema.STRING,
        "oa11": glue.Schema.STRING,
        "lsoa11": glue.Schema.STRING,
        "msoa11": glue.Schema.STRING,
        "wz11": glue.Schema.STRING,
        "sicbl": glue.Schema.STRING,
        "bua24": glue.Schema.STRING,
        "ru11ind": glue.Schema.STRING,
        "oac11": glue.Schema.STRING,
        "lat": glue.Schema.STRING,
        "long": glue.Schema.STRING,
        "lep1": glue.Schema.STRING,
        "lep2": glue.Schema.STRING,
        "pfa": glue.Schema.STRING,
        "imd": glue.Schema.STRING,
        "calncv": glue.Schema.STRING,
        "icb": glue.Schema.STRING,
        "oa21": glue.Schema.STRING,
        "lsoa21": glue.Schema.STRING,
        "msoa21": glue.Schema.STRING,
    },
)
